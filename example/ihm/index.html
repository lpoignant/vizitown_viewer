<html>

<head>
	<meta charset="UTF-8" />
	<title>Viewer VIZITOWN</title>
	<script type="text/javascript" src="./libs/js/jquery-1.9.0.js"></script>
	<script type="text/javascript" src="./libs/js/jquery-ui-1.10.4.custom.min.js"></script>
	<script type="text/javascript" src="./libs/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="./libs/js/zoomslider.js"></script>
	<script type="text/javascript" src="../js/Vizitown.js"></script>
	<link rel="stylesheet" href="./libs/css/viewer.css">
	<link rel="stylesheet" href="./libs/css/jquery-ui-1.10.4.custom.min.css">
	<link rel="stylesheet" href="./libs/css/bootstrap.min.css">

</head>

<body>

<div id="main_map">
</div>
<div id="settingsButton">
	<button id="btnModal" class="btn btn-primary btn-lg open" data-toggle="modal" data-target="#myModal">^</button>
</div>

<div id="slider-vertical"></div>

<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			
			<div class="modal-header">
				<button type="button" id="closeModal" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<h4 class="settings" id="myModalLabel">Paramètres</h4>
			</div>

			<div class="modal-body">	
		      <div class="row">
		        <div class="col-md-6"><b>Profondeur de champs</b></div>
		        <div class="col-md-6"><input type="text" name="deep" id="deepInput"/></div>
		      </div>

		      <div class="row">
		        <div class="col-md-12"></div>
		      </div>

		      <div class="row">
		        <div class="col-md-6"><b>Angle de la camera</b></div>
		        <div class="col-md-6"><input type="text" name="angle" id="angleInput"/></div>
		      </div>

		      <br><br>
		      <!-- <div class="row" id = "controlsRadio">
		        <div class="col-md-4"><b>Controls</b></div>
		        <div class="col-md-4"><input type="radio" name="controls" value="fly">Fly</div>
		        <div class="col-md-4"><input type="radio" name="controls" value="trackball">Trackball</div>
		      </div> -->

		      <div class="row" id = "ssaoCheckbox">
		        <div class="col-md-4"><b>SSAO</b></div>
		        <div class="col-md-4"><input type="checkbox" name="myradio" value="ssao1">SSAO 1</div>
		        <div class="col-md-4"><input type="checkbox" name="myradio" value="ssao2">SSAO 2</div>
		      </div>

		      <div class="row">
		        <div class="col-md-4"><b>Ombre</b></div>
		        <div class="col-md-4"><input type="radio" name=myradio value="1">Activé</div>
		        <div class="col-md-4"><input type="radio" name=myradio value="2">Désactivé</div>
		      </div>
			</div>

			<div class="modal-footer">
				<button type="button" class="btn btn-primary" id="save" data-dismiss="modal" aria-hidden="true" onclick="saveParameters()">Sauvegarder / Rafraîchir</button>
			</div>
		</div>
	</div>
</div>
<script type="text/javascript">

	var req = new XMLHttpRequest();
	req.open('GET', "http://localhost:8888/init", false); 
	req.send(null);
	if (req.status != 200) {
	    throw "No scene defined";
	}
	
	var sceneSettings = JSON.parse(req.responseText);
	var scene = new Scene({
	    window: window,
	    document: document,
	    domId: "main_map",
	    extent: {
	        minX: parseFloat(sceneSettings.extent.xMin),
	        minY: parseFloat(sceneSettings.extent.yMin),
	        maxX: parseFloat(sceneSettings.extent.xMax),
	        maxY: parseFloat(sceneSettings.extent.yMax),
	    },
		url: "localhost:8888",
	});

	var changeZoomLevel = function(value) {
	    scene.zoom(value);
	};

	var saveParameters = function() {
	    scene._camera.fov = document.getElementById('angleInput').value;
	    scene._camera.far = document.getElementById('deepInput').value;
	    scene._scene.fog.far = document.getElementById('deepInput').value;
	};
	
	console.log(scene);
	scene.render();
        document.getElementById('angleInput').value = scene._camera.fov;
        document.getElementById('deepInput').value = scene._camera.far;
        document.getElementById('deepInput').value = scene._scene.fog.far;
</script>
</body>
</html>
